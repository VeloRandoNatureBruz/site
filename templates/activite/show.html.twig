{% extends 'base.html.twig' %}

{% block body %}
	<div class="container container-profil">

		{% if is_granted("ROLE_ADMIN") %}
			<div class="boutonModifierTexte">
				<button class="button_show btn btn-outline-success">Modifier la photo</button>
			</div>
			<div class="form-group formulaire" id="form">
				{{ form(formPhotoIntro) }}
				<div class="mt-3 mb-5 text-center">
					<button class="button_close btn btn-outline-secondary">Annuler</button>
				</div>
			</div>
		{% endif %}
	</div>

	<div class="center-hr">
		<hr class="hr25-pourcent center">
	</div>

	<div class="container">
		<div class="row justify-content-center">
			<div class="col-lg-8">
				<div class="row col-md-12 centered-activite">
					{% if (activite.etat.libelle == "ouverte" or activite.etat.libelle == "modifiée") %}
						<div class="activite-container row col-10">
							<div class="sans-detail-container row col-12">
								<div class="date-container col-lg-4 col-sm-12 col-xs-12">
									<p id="date-activite">{{ activite.dateActivite()|date('j') }}</p>
									<p>{{ activite.dateActivite()|format_datetime(locale='fr',pattern="MMMM") }}</p>
									<p>{{ activite.dateActivite()|format_datetime(locale='fr',pattern="Y") }}</p>
									<p>{{ activite.dateActivite()|date('H:i') }}</p>
								</div>

								<div class="nom-container row col-10">
									<div class="info-activite row col-12">
										<div class="title-container-programme">
											<p id="title-activite">{{ activite.nom }}</p>
										</div>
										<div class="type-activite-lieu row col-12">
											<div class="type-activite">
												<p class="font-bold-activite">Activité:</p>
											</div>
											<div class="type-activite">
												<p class="padding-activite">{{ activite.categoriesFormation().getLibelle() }}</p>
											</div>
											<div class="type-activite">
												<p class="font-bold-activite">Ville:</p>
												<p class="padding-activite">{{ activite.lieu.nomVille|slice(0,20) }}</p>
											</div>
										</div>
									</div>
									<div class="is-inscrit col-3">
										{% if activite.users.contains(user) %}
											<img src="{{ asset("tools/check.png") }}" alt="symbole de la vérification">
										{% endif %}
									</div>
								</div>
							</div>

							<div class="detail-container col-11">
								<div class="row">
									<div class="detail-gauche col-8">
										<div class="type-activite">
											<p class="font-bold-activite">Organisateur:</p>
											<a href="{{ path('user_show', {'id': activite.organisateur.id}) }}">
												{{ activite.organisateur.prenom }} {{ activite.organisateur.nom }}</a>
										</div>
										<div class="type-activite">
											<p class="font-bold-activite">Durée:</p>
											<p>{{ activite.duree }} minutes</p>
										</div>
										{% if (activite.distance == 0 or activite.distance == '') %}
										{% else %}
											<div class="type-activite">
												<p class="font-bold-activite">Distance:</p>
												<p>{{ activite.distance }} kilomètres</p>
											</div>
										{% endif %}
										{% if (activite.denivele == 0 or activite.denivele == '') %}
										{% else %}
											<div class="type-activite">
												<p class="font-bold-activite">Dénivelé:</p>
												<p>{{ activite.denivele }} mètres</p>
											</div>
										{% endif %}
										<div class="type-activite">
											<p class="font-bold-activite">Lieu de rassemblement:</p>
											<p>{{ activite.lieu().getNomRue() }}</p>
										</div>
										{% if (activite.getInfosActivite() == '') %}
										{% else %}
											<div class="type-activite">
												<p class="font-bold-activite">Info activité:</p>
												<p>{{ activite.getInfosActivite() }}</p>
											</div>
										{% endif %}
										{% if (activite.getPdf() == null or activite.getPdf() == '') %}
										{% else %}
											<div class="type-activite">
												<a href="{{ path('activite_show_pdf',{"id":activite.id}) }}" target="_blank">document lié à l'activité</a>
											</div>
										{% endif %}
									</div>
									<div class="detail-droite col-4">
										<div class="difficulte-activite">
											{% if (activite.getDifficulte() == 0 or activite.getDifficulte() == '') %}
											{% else %}
												{% if ( activite.getDifficulte() == 1) %}
													<img src="{{ asset("tools/difficulte1.png") }}" alt="icone difficulté niveau un">
												{% elseif ( activite.getDifficulte() == 2) %}
													<img src="{{ asset("tools/difficult2.png") }}" alt="icone difficulté niveau deux">
												{% else %}
													<img src="{{ asset("tools/difficult3.png") }}" alt="icone difficulté niveau trois">
												{% endif %}
											{% endif %}
										</div>
									</div>
								</div>
							</div>

							<div class="buton-container row col-12">
								<div class="inscrit col-12">
									{% if (activite.users.count) == 0 %}
										<p class="lead">Il n'y pas encore d'inscrit à cette activité</p>
									{% elseif (activite.users.count) == 1 %}
										<div class="col-12">
											<p class="lead">{{ activite.users.count }} adhérent inscrit à cette activité :</p>
											<ol class="p-0">
												{% for user in activite.users %}
													<li class="list-unstyled">{{ user.userIdentifier }}</li>
												{% endfor %}
											</ol>
										</div>
									{% else %}
										<div class="col-12">
											<p class="lead">{{ activite.users.count }} adhérents inscrits à cette activité :</p>
											<ol class="  ">
												{% for user in activite.users %}
													<li class="list-unstyled">{{ user.userIdentifier }}</li>
												{% endfor %}
											</ol>
										</div>
									{% endif %}
									<div class="boutton_box col-12 col-sm-10 col-xs-10">
										{% if is_granted("ROLE_USER") %}
											{% if is_granted("ROLE_ADMIN") %}
												<a class="btn btn-success btn-sm" href="{{ path('activite_edit', {'id': activite.id}) }}">Modifier</a>
												<a class="btn btn-warning btn-sm" href="{{ path('delete_activite', {'id': activite.id}) }}" onclick="return confirm('Voulez-vous vraiment supprimer cette activité?')">Supprimer</a>
											{% endif %}
											{% if (activite.users.contains(user)) %}
												<a class="btn btn-secondary btn-sm" href="{{ path('activite_sedesister', {'id': activite.id}) }}">Se désister</a>
											{% else %}
												<a class="btn btn-success btn-sm" href="{{ path('activite_sinscrire', {'id': activite.id}) }}">S'inscrire</a>
											{% endif %}
										{% endif %}
									</div>
								</div>
							</div>
						</div>
					{% endif %}
				</div>
			</div>
		</div>
	</div>

	<script>
		function starsSorter(a, b) {
			if (new Date(a) > new Date(b))
				return 1;
			if (new Date(a) < new Date(b))
				return -1;
			return 0;
		}
	</script>
{% endblock %}
